---
import { getLangFromUrl, useTranslations } from "@/i18n/utils"
import Moon from "./icons/Moon.astro"
import Sun from "./icons/Sun.astro"

const url = Astro.url
const lang = getLangFromUrl(url);
const t = useTranslations(lang);

---

<label  for="switcher" class="swap hover:opacity-80 hover:scale-105">
  <input id="switcher" class="appearance-none" type="checkbox" aria-label={t("acc.switchLight")} />
  <Moon />
  <Sun />
</label>


<script>
  import { getLangFromUrl, useTranslations } from "../i18n/utils";


  const url = new URL(window.location.href.toString());
  const lang = getLangFromUrl(url);
  const t = useTranslations(lang);
  
  const themeButton = document.querySelector("input");

 
  document.addEventListener("DOMContentLoaded", () => {
    themeButton?.addEventListener("click", () => {
      const isDark = document.documentElement.classList.value === "dark";
      if (isDark) {
        document.documentElement.classList.remove("dark");
        localStorage.setItem("theme", "light");
      } else {
        document.documentElement.classList.add("dark");
        localStorage.setItem("theme", "dark");
      }
      updateAriaLabel(!isDark ? "dark" : "light");
    });
  });

  function updateAriaLabel(currentTheme: string) {
    if (currentTheme === "dark") {
      themeButton.ariaLabel = t("acc.switchLight");
    } else {
      themeButton.ariaLabel = t("acc.switchDark");
    }
  }
</script>
